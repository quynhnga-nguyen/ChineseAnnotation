(function(){function m(a,c,d){"class"==c?a.className=d:"style"==c?a.defaultChecked=d:"for"==c?a.htmlFor=d:"checked"==c?a.style.cssText=d:a.setAttribute(c,d)}function D(a,c){var d=document.createElement("style");m(d,"id",c);m(d,"type","text/css");d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a));J.appendChild(d)}function w(a){a=a.charCodeAt(0);return 19968<=a&&40879>=a}function E(a){var c=[];if(3==a.nodeType){if(void 0==a.nodeValue)return;var d;d=a.nodeValue;for(var b=[],
f=0;f<d.length;){for(var e=f+1,g=w(d.charAt(f));e<d.length&&w(d.charAt(e))==g;)++e;b.push([g,f,e]);f=e}d=1==b.length&&!w(d.charAt(b[0][1]))||0==b.length?[]:b;d.length&&c.push([a,d])}else if(1==a.nodeType){if(a.nodeName.toLowerCase()in{textarea:1,"x-mspot":1,script:1,style:1,option:1})return;b=0;for(f=a.childNodes.length;b<f;++b)(d=E(a.childNodes[b]))&&(c=c.concat(d))}return c}function C(){document.getElementById("mandarinspot-progress").parentNode.style.display="none"}function F(a,c,d,b){var f=[],
e;for(e in d){var g=d[e];void 0!=g&&f.push(e+"="+g)}var f=f.join("&"),h=new XMLHttpRequest;"withCredentials"in h?(h.open(a,c,!0),"POST"==a&&(h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.setRequestHeader("Content-Length",String(f.length)))):"undefined"!=typeof XDomainRequest?(h=new XDomainRequest,h.open(a,c)):h=null;h.onload=function(){if(399<h.status)b(h.status);else{var a=eval("("+h.responseText+")");b(null,a)}};h.send(f)}function K(a,c){F("GET",a,{},c)}function L(a,c,
d){F("POST",a,c,d)}function M(a,c,d){var b=["\r\n"],f;for(f in c){var e=c[f];void 0!=e&&b.push('Content-Disposition: form-data; name="'+f+'"\r\n\r\n'+e+"\r\n")}var b=b.join("--boundary\r\n")+"--boundary--\r\n",g=new XMLHttpRequest;g.open("POST",a,!0);g.setRequestHeader("Content-Type","multipart/form-data; boundary=boundary");g.setRequestHeader("Content-Length",String(b.length));g.onreadystatechange=function(){if(4==g.readyState&&200==g.status){var a=eval("("+g.responseText+")");d(null,a)}};g.send(b)}
function N(a){for(var c=[],d=0,b=a.length;d<b;++d){for(var f=a[d],e="",g=0,h=f.length;g<h;++g)e+=(f.charCodeAt(g)-8192).toString(32);c.push(e)}return c}function O(a){for(var c=[],d=0,b=a.length;d<b;++d){for(var f=a[d],e="",g=0,h=f.length;g<h;++g)var l=f.charCodeAt(g),e=e+String.fromCharCode(224|15&l>>>12),e=e+String.fromCharCode(128|63&l>>>6),e=e+String.fromCharCode(128|63&l);c.push(e)}return c}function P(a,c){function d(a){var b=a.seg,d=B;a=a.defs;for(var f in a)d[f]=a[f];d=c;f=0;for(a=d.length;f<
a;++f){for(var e=d[f][0],g=d[f][1],h=0,l=g.length;h<l;++h){var z=g[h],n=e.nodeValue.slice(z[1],z[2]),t=document.createTextNode(n);if(z[0])for(var z=b.shift(),r=0,m=0,y=z.length;m<y;++m){var G=parseInt(z[m],32),A=document.createElement("wbr"),t=document.createTextNode(n.slice(r,r+G)),w=document.createElement("x-mspot");w.appendChild(t);var t=w,x=Q;t.addEventListener?t.addEventListener("mouseover",x,!1):t.attachEvent?t.attachEvent("onmouseover",x):t.onmouseover=x;e.parentNode.insertBefore(A,e);e.parentNode.insertBefore(w,
e);r+=G}else e.parentNode.insertBefore(t,e)}e.parentNode&&e.parentNode.removeChild(e)}C()}if(c.length){for(var b=[],f=0,e=c.length;f<e;++f)for(var g=c[f],h=g[0],g=g[1],l=0,n=g.length;l<n;++l){var r=g[l];r[0]&&b.push(h.nodeValue.slice(r[1],r[2]))}f=R(O(b).join(",")+a);K(S+f,function(c,e){if(404==c){if(A.g){var f=L;b=N(b).join(",")}else f=M,b=b.join(",");f(T,{str:b,phs:a},function(a,b){d(b)})}else d(e)})}else C()}function Q(a,c){if(x){var d=a.target||a.srcElement;d.onmouseout=function(){n.style.visibility=
"hidden";n.style.left="-1000px";n.style.top="-1000px";n.style.width="";A.h(d)};A.i(d);c=c?c:d.lastChild.nodeValue?d.lastChild.nodeValue:d.lastChild.lastChild.nodeValue;var b=B[c][0],f=B[c][1],e=B[c][2],g="";if(c!==e){for(var h=0;h<c.length;++h)g+=c[h]!==e[h]?e[h]:"-";g=" ["+g+"]"}e='<div id="mandarinspot-tip-hz" style="font-size:150%;"><x-mspot>'+c+g+"</x-mspot></div>";h=0;for(g=b.length;h<g;++h)var l=y?f[h].replace(/([^<])\//g,"$1 / "):"• "+f[h].replace(/([^<])\//g,"$1<br />• "),e=e+('<div id="mandarinspotspot-tip-py" style="font-weight:bold">'+
b[h]+'</div><div id="mandarinspotspot-tip-en" style="text-align:left;font-size:90%">'+l+"</div>");mandarinspot.bookmark||(e+='<div id="mandarinspotspot-tip-fo" style="font-size:xx-small;color:#777;text-align:center;margin-top:1ex">MandarinSpot.com</div>');n.innerHTML=e;A.j(d,n);n.style.visibility="visible"}}function U(a){var c=document.body;if("undefined"!=typeof c)if("undefined"==typeof a)a=document.body;else if("string"==typeof a){var d=a[0],b=a.slice(1);if("#"==d)return[document.getElementById(b)];
if("."==d){if(c.getElementsByClassName)a=c.getElementsByClassName(b);else{a=[];for(var b=RegExp("(?:^| )"+b+"(?: |$)"),c=c.getElementsByTagName("*"),d=0,f=c.length;d<f;++d)b.test(c[d].className)&&a.push(c[d])}return a}}return[a]}function H(a,c){c=c||{};var d=c.phonetic||"pinyin",b=c.show||!0,f=U(a),e=[];mandarinspot.bookmark?document.getElementById("mandarinspot-progress").parentNode.style.display="block":C();for(var g=0,h=f.length;g<h;++g)e=e.concat(E(f[g]));document.getElementById("mandarinspot-progress").innerHTML=
"Loading...";P(d,e);x=b}function R(a){function c(a){var b="",c,d;for(c=7;0<=c;c--)d=a>>>4*c&15,b+=d.toString(16);return b}function d(a,b){return a<<b|a>>>32-b}var b,f,e=Array(80),g=1732584193,h=4023233417,l=2562383102,n=271733878,r=3285377520,k,p,q,m,u;k=a.length;var v=[];for(b=0;b<k-3;b+=4)f=a.charCodeAt(b)<<24|a.charCodeAt(b+1)<<16|a.charCodeAt(b+2)<<8|a.charCodeAt(b+3),v.push(f);switch(k%4){case 0:b=2147483648;break;case 1:b=a.charCodeAt(k-1)<<24|8388608;break;case 2:b=a.charCodeAt(k-2)<<24|a.charCodeAt(k-
1)<<16|32768;break;case 3:b=a.charCodeAt(k-3)<<24|a.charCodeAt(k-2)<<16|a.charCodeAt(k-1)<<8|128}for(v.push(b);14!=v.length%16;)v.push(0);v.push(k>>>29);v.push(k<<3&4294967295);for(a=0;a<v.length;a+=16){for(b=0;16>b;b++)e[b]=v[a+b];for(b=16;79>=b;b++)e[b]=d(e[b-3]^e[b-8]^e[b-14]^e[b-16],1);f=g;k=h;p=l;q=n;m=r;for(b=0;19>=b;b++)u=d(f,5)+(k&p|~k&q)+m+e[b]+1518500249&4294967295,m=q,q=p,p=d(k,30),k=f,f=u;for(b=20;39>=b;b++)u=d(f,5)+(k^p^q)+m+e[b]+1859775393&4294967295,m=q,q=p,p=d(k,30),k=f,f=u;for(b=
40;59>=b;b++)u=d(f,5)+(k&p|k&q|p&q)+m+e[b]+2400959708&4294967295,m=q,q=p,p=d(k,30),k=f,f=u;for(b=60;79>=b;b++)u=d(f,5)+(k^p^q)+m+e[b]+3395469782&4294967295,m=q,q=p,p=d(k,30),k=f,f=u;g=g+f&4294967295;h=h+k&4294967295;l=l+p&4294967295;n=n+q&4294967295;r=r+m&4294967295}return(c(g)+c(h)+c(l)+c(n)+c(r)).toLowerCase()}var J=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.documentElement,I=document.getElementsByTagName("body")[0]||document.documentElement,y=-1!=
navigator.userAgent.toLowerCase().indexOf("mobile");window.mandarinspot||(window.mandarinspot={});var V="#mandarinspot-progressslot{position:fixed;display:block;z-index:1000;top:0;left:0;width:100%;border:none}#mandarinspot-progress{margin:0 "+(y?"0":"auto")+";padding:.4ex 0;background-color:#ff9;color:#000;width:22ex;text-align:center;font:normal 14px sans-serif,arial;border:none}";document.getElementById("mandarinspot-style")||D("#mandarinspot-tip{text-align:center;z-index:10001;border:1px solid #773;border-radius:3px;background-color:#ffc;color:#000;padding:5px;padding-bottom:2px;font:normal 14px sans-serif,arial;visibility:hidden;position:absolute}#mandarinspot-tip-hz{font-size:150%;border:none}#mandarinspotspot-tip-py{font-weight:bold;border:none}#mandarinspotspot-tip-en{text-align:left;font-size:90%;border:none}#mandarinspotspot-tip-fo{font-size:xx-small;color:#777;text-align:center;margin-top:1ex;border:none}.mspot{margin:0;padding:0;border:none;width:auto;height:auto}",
"mandarinspot-style");document.getElementById("mandarinspot-progress-style")||D(V,"mandarinspot-progress-style");document.getElementById("mandarinspot-tip")||(s=document.createElement("div"),m(s,"id","mandarinspot-tip"),m(s,"class","mspot"),I.appendChild(s));document.getElementById("mandarinspot-progressslot")||(s=document.createElement("div"),m(s,"id","mandarinspot-progressslot"),m(s,"class","mspot"),mandarinspot.bookmark||(s.style.display="none"),s.innerHTML='<div id="mandarinspot-progress">Loading..</div>',
I.appendChild(s));var S="https://api.mandarinspot.com/cache/",T="https://api.mandarinspot.com/getdefs",B={},A={d:y?200:300,e:y?50:100,c:"",i:function(a){this.c=a.style.backgroundColor;a.style.backgroundColor="#fe7"},h:function(a){a.style.backgroundColor=this.c},f:function(a){return a.getBoundingClientRect?(a=a.getBoundingClientRect(),[a.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft),a.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)]):
[this.a(a),this.b(a)]},a:function(a){return(a.offsetLeft||0)+(a.offsetParent&&this.a(a.offsetParent)||0)},b:function(a){return(a.offsetTop||0)+(a.offsetParent&&this.b(a.offsetParent)||0)},j:function(a,c){var d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,f=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,e=window.pageYOffset||document.documentElement.scrollTop||
document.body.scrollTop,g=this.f(a),h=g[0],l=g[1],g=!1;c.offsetWidth>this.d?c.style.width=this.d+"px":c.offsetWidth<this.e&&(c.style.width=this.e+"px");l=l-e>c.offsetHeight+15?l-3-c.offsetHeight:l+3+a.offsetHeight;if(l<e||l+c.offsetHeight>e+b)l=e,g=!0;c.style.top=l+"px";y?tipleft=Math.max(f,h-c.offsetWidth):g?tipleft=0>a.offsetWidth||h<c.offsetWidth?h+a.offsetWidth:h-c.offsetWidth:(b=Math.min(30,Math.abs(a.offsetWidth)/2),tipleft=d+f-h-a.offsetWidth<c.offsetWidth+15?h+b-c.offsetWidth:h+b,0>tipleft&&
(tipleft=0));c.style.left=tipleft+"px"},g:document.all},n=document.getElementById("mandarinspot-tip"),x=!0;window.mandarinspot||(window.mandarinspot={});mandarinspot.annotate=H;mandarinspot.showPopups=function(a){x=a};mandarinspot.supported=function(){return"withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest?!0:!1};mandarinspot.run=function(){H(document.body,{phonetic:mandarinspot.phonetic,show:!0})};mandarinspot.bookmark&&mandarinspot.run()})();
